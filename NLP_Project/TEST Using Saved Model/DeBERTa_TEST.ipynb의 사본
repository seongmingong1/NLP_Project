{"cells":[{"cell_type":"markdown","metadata":{"id":"view-in-github"},"source":["<a href=\"https://colab.research.google.com/github/aidot-kr/AISecurity/blob/master/13_BERT_Classification.ipynb\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"]},{"cell_type":"markdown","metadata":{"id":"PMG424NB_OjB"},"source":["## 1. 구글드라이브와 Colab 연동"]},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CfMWPIrwT5To","executionInfo":{"status":"ok","timestamp":1688160888974,"user_tz":-120,"elapsed":54290,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"675055ec-9cf0-4777-8d32-3af832041eff"},"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting mxnet\n","  Downloading mxnet-1.9.1-py3-none-manylinux2014_x86_64.whl (49.1 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m49.1/49.1 MB\u001b[0m \u001b[31m15.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy<2.0.0,>1.16.0 in /usr/local/lib/python3.10/dist-packages (from mxnet) (1.22.4)\n","Requirement already satisfied: requests<3,>=2.20.0 in /usr/local/lib/python3.10/dist-packages (from mxnet) (2.27.1)\n","Collecting graphviz<0.9.0,>=0.8.1 (from mxnet)\n","  Downloading graphviz-0.8.4-py2.py3-none-any.whl (16 kB)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.20.0->mxnet) (1.26.16)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.20.0->mxnet) (2023.5.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.20.0->mxnet) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests<3,>=2.20.0->mxnet) (3.4)\n","Installing collected packages: graphviz, mxnet\n","  Attempting uninstall: graphviz\n","    Found existing installation: graphviz 0.20.1\n","    Uninstalling graphviz-0.20.1:\n","      Successfully uninstalled graphviz-0.20.1\n","Successfully installed graphviz-0.8.4 mxnet-1.9.1\n","Collecting gluonnlp\n","  Downloading gluonnlp-0.10.0.tar.gz (344 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m344.5/344.5 kB\u001b[0m \u001b[31m20.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\n","Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.10/dist-packages (from gluonnlp) (1.22.4)\n","Requirement already satisfied: cython in /usr/local/lib/python3.10/dist-packages (from gluonnlp) (0.29.35)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from gluonnlp) (23.1)\n","Building wheels for collected packages: gluonnlp\n","  Building wheel for gluonnlp (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for gluonnlp: filename=gluonnlp-0.10.0-cp310-cp310-linux_x86_64.whl size=681079 sha256=90d30187c778b1b022abd6b9006f3c086bf837c61705fb5986bf55d7385bec3d\n","  Stored in directory: /root/.cache/pip/wheels/1a/1e/0d/99f55911d90f2b95b9f7c176d5813ef3622894a4b30fde6bd3\n","Successfully built gluonnlp\n","Installing collected packages: gluonnlp\n","Successfully installed gluonnlp-0.10.0\n","Collecting transformers\n","  Downloading transformers-4.30.2-py3-none-any.whl (7.2 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.2/7.2 MB\u001b[0m \u001b[31m73.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from transformers) (3.12.2)\n","Collecting huggingface-hub<1.0,>=0.14.1 (from transformers)\n","  Downloading huggingface_hub-0.15.1-py3-none-any.whl (236 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m236.8/236.8 kB\u001b[0m \u001b[31m31.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (1.22.4)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from transformers) (23.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from transformers) (6.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.10/dist-packages (from transformers) (2022.10.31)\n","Requirement already satisfied: requests in /usr/local/lib/python3.10/dist-packages (from transformers) (2.27.1)\n","Collecting tokenizers!=0.11.3,<0.14,>=0.11.1 (from transformers)\n","  Downloading tokenizers-0.13.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (7.8 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m7.8/7.8 MB\u001b[0m \u001b[31m66.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hCollecting safetensors>=0.3.1 (from transformers)\n","  Downloading safetensors-0.3.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m84.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.10/dist-packages (from transformers) (4.65.0)\n","Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (2023.6.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub<1.0,>=0.14.1->transformers) (4.6.3)\n","Requirement already satisfied: urllib3<1.27,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (1.26.16)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2023.5.7)\n","Requirement already satisfied: charset-normalizer~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (2.0.12)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests->transformers) (3.4)\n","Installing collected packages: tokenizers, safetensors, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.15.1 safetensors-0.3.1 tokenizers-0.13.3 transformers-4.30.2\n","Collecting sentencepiece\n","  Downloading sentencepiece-0.1.99-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.3/1.3 MB\u001b[0m \u001b[31m68.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: sentencepiece\n","Successfully installed sentencepiece-0.1.99\n","Collecting neattext\n","  Downloading neattext-0.1.3-py3-none-any.whl (114 kB)\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m114.7/114.7 kB\u001b[0m \u001b[31m8.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hInstalling collected packages: neattext\n","Successfully installed neattext-0.1.3\n"]}],"source":["!pip install mxnet\n","!pip install gluonnlp\n","!pip install transformers\n","!pip install sentencepiece\n","!pip install neattext"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"DEr0qWKs4LJB","executionInfo":{"status":"ok","timestamp":1688160900032,"user_tz":-120,"elapsed":11064,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","import os\n","import gc\n","\n","import random\n","\n","import torch\n","import torch.nn as nn\n","import torch.optim as optim\n","import torch.nn.functional as F\n","from torch.utils.data import Dataset, DataLoader\n","\n","# seed 값 설정\n","torch.manual_seed(555)\n","\n","from sklearn.utils import shuffle\n","from sklearn.metrics import accuracy_score\n","\n","import transformers\n","from transformers import AdamW\n","\n","from tqdm import tqdm\n","import warnings\n","warnings.filterwarnings(\"ignore\")"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":20682,"status":"ok","timestamp":1688160920711,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"zXe3FH98e8O2","outputId":"59d3517f-8730-4cd0-c3e7-038642fff8b2"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}],"source":["import os\n","from google.colab import drive\n","drive.mount('/content/drive')"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"XOTJjsZA_vyL","executionInfo":{"status":"ok","timestamp":1688160923818,"user_tz":-120,"elapsed":3109,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"outputs":[],"source":["file_path1 ='/content/drive/My Drive/bert/newdata0627.csv'\n","df = pd.read_csv(file_path1)"]},{"cell_type":"code","source":["df.rename(columns={'text': 'Text'}, inplace=True)"],"metadata":{"id":"OjKFlBS_ObX0","executionInfo":{"status":"ok","timestamp":1688160923818,"user_tz":-120,"elapsed":7,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":5,"outputs":[]},{"cell_type":"code","execution_count":6,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1688160923818,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"NE8myOzGRG6y","outputId":"7edd589f-683c-4c7a-f4ae-a4ba268b39bf"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                Text  oh_label\n","0  Ain't nothing that good head or pussy that cur...         1\n","1  @user @user Seemed bona fide to me when I did ...         0\n","2  @user @user @user @user @user @user @user @use...         0\n","3  @USER RODRICK ISN'T EVEN THAT BAD IS THE THING...         1\n","4  Pretty sure I got ya bitch nudes in my phone n...         1"],"text/html":["\n","  <div id=\"df-439219c5-b71a-4ce8-b791-39cd43177482\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>oh_label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Ain't nothing that good head or pussy that cur...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>@user @user Seemed bona fide to me when I did ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>@user @user @user @user @user @user @user @use...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>@USER RODRICK ISN'T EVEN THAT BAD IS THE THING...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Pretty sure I got ya bitch nudes in my phone n...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-439219c5-b71a-4ce8-b791-39cd43177482')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-439219c5-b71a-4ce8-b791-39cd43177482 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-439219c5-b71a-4ce8-b791-39cd43177482');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":6}],"source":["df.head()"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1688160924332,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"Jd4XE597RGqI","outputId":"af81032e-000f-4974-abd2-a49f66e8eed4"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["1    42045\n","0    42045\n","Name: oh_label, dtype: int64"]},"metadata":{},"execution_count":7}],"source":["df['oh_label'].value_counts()"]},{"cell_type":"code","execution_count":8,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1688160924333,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"9cT1wi_aR2V7","outputId":"bca206ec-395c-48be-b5ec-9c4874ab07fb"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Text        0\n","oh_label    0\n","dtype: int64"]},"metadata":{},"execution_count":8}],"source":["# 데이터 1 칼럼 불필요 한거 없애기\n","df.isnull().sum()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1686942925042,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"aalm6I1hR2ST","outputId":"effc61e8-95ab-4520-cfd1-8b19d769da46"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                Text  oh_label\n","0  This: :One can make an analogy in mathematical...         0\n","1  `  :Clarification for you  (and Zundark's righ...         0\n","2                          Elected or Electoral? JHK         0\n","3  `This is such a fun entry.   Devotchka  I once...         0\n","4  Please relate the ozone hole to increases in c...         0"],"text/html":["\n","  <div id=\"df-f27379db-d261-439b-8a46-eafbf03de429\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>oh_label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>This: :One can make an analogy in mathematical...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>`  :Clarification for you  (and Zundark's righ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Elected or Electoral? JHK</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>`This is such a fun entry.   Devotchka  I once...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Please relate the ozone hole to increases in c...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-f27379db-d261-439b-8a46-eafbf03de429')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-f27379db-d261-439b-8a46-eafbf03de429 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-f27379db-d261-439b-8a46-eafbf03de429');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}],"source":["df = df.drop(columns=['index','ed_label_0','ed_label_1'])\n","df.head()"]},{"cell_type":"code","source":["df_zero = df[df['oh_label'] == 0].sample(n=15362, random_state=1)"],"metadata":{"id":"S_g5iyRhibpD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_one = df[df['oh_label'] == 1]\n","balanced_df = pd.concat([df_zero, df_one])\n"],"metadata":{"id":"e5KpjlEwie9y"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["balanced_df['oh_label'].value_counts()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"O4peLCxPifVx","executionInfo":{"status":"ok","timestamp":1686942929828,"user_tz":-120,"elapsed":1,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"93c11bfb-df12-40d4-8521-ba0600a09ceb"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0    15362\n","1    15362\n","Name: oh_label, dtype: int64"]},"metadata":{},"execution_count":11}]},{"cell_type":"code","source":["df = balanced_df"],"metadata":{"id":"GJ79P3SrihVo"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(df.isnull())"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QWXtYzmFimpd","executionInfo":{"status":"ok","timestamp":1688160925925,"user_tz":-120,"elapsed":2,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"84c88c18-ab67-4ef2-afbe-63b1073c20c6"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stdout","text":["        Text  oh_label\n","0      False     False\n","1      False     False\n","2      False     False\n","3      False     False\n","4      False     False\n","...      ...       ...\n","84085  False     False\n","84086  False     False\n","84087  False     False\n","84088  False     False\n","84089  False     False\n","\n","[84090 rows x 2 columns]\n"]}]},{"cell_type":"code","source":["df = df.reset_index(drop=True)"],"metadata":{"id":"7hXZQvpKiuU9","executionInfo":{"status":"ok","timestamp":1688160930241,"user_tz":-120,"elapsed":2,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["import neattext as nt\n","import neattext.functions as nfx\n","import re"],"metadata":{"id":"R9z8bopWedzZ","executionInfo":{"status":"ok","timestamp":1688160932150,"user_tz":-120,"elapsed":1,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["from html import unescape\n","# Preprocess text function\n","def preprocess_text(text):\n","    # 1. Find #[xX]?\\w+; and put '&' to the first\n","    text = re.sub(r'(^|\\D)#\\w+;', lambda match: f'&{match.group()}' if match.group().startswith('#') else f'{match.group()[0]}&{match.group()[1:]}', text)\n","    # 2. Convert HTML character to unicode\n","    text = unescape(text)\n","    # 3. Remove http, https\n","    text = re.sub(r'http\\S+|https\\S+', '', text)\n","    # 4. Remove email\n","    text = re.sub(r'\\S+@\\S+', '', text)\n","    # 5. Remove twitter id\n","    text = re.sub(r'@\\w+', '', text)\n","    # 6. Remove \"&lt;/b&gt;\"\n","    text = re.sub(r'&lt;/b&gt;', '', text)\n","    # 7. Remove &quot; and quot;\n","    text = re.sub(r'&quot;|quot;', '', text)\n","    # 8. Replace &amp; and amp; with &\n","    text = re.sub(r'&amp;|amp;', '&', text)\n","    # 9. Replace &lt; and lt; with <\n","    text = re.sub(r'&lt;|lt;', '<', text)\n","    # 10. Replace &gt; and gt; with >\n","    text = re.sub(r'&gt;|gt;', '>', text)\n","    # 11. Remove the text inside parentheses\n","    text = re.sub(r'\\(.*?\\)', '', text)\n","    # 12. Remove extra spaces\n","    text = re.sub(r'\\s+', ' ', text).strip()\n","    # 13. Remove #\n","    text = re.sub(r'#[\\w]*', '', text)\n","    # Remove user handles\n","    text = re.sub(r'@\\w+', '', text)\n","    # Remove multiple spaces\n","    text = re.sub(r'\\s+', ' ', text)\n","\n","    return text"],"metadata":{"id":"HUpErwewcaQ1","executionInfo":{"status":"ok","timestamp":1688160933297,"user_tz":-120,"elapsed":395,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["df['Text'] = df['Text'].apply(preprocess_text)"],"metadata":{"id":"8GS3c87qeaK2","executionInfo":{"status":"ok","timestamp":1688160940798,"user_tz":-120,"elapsed":5887,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","execution_count":14,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":499,"status":"ok","timestamp":1688160941295,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"tx11Z84Ve2DK","outputId":"17eb7752-7a7e-4e54-f168-7797f415a883"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                Text  oh_label\n","0         Ain't good head pussy curl yah toes up&😂&😩         1\n","1                  bona fide quick check . instance;         0\n","2             claims is. That's logical explanation.         0\n","3  RODRICK BAD THING LIKE HE'S DICK HE'S ENJOYABL...         1\n","4         Pretty sure got ya bitch nudes phone nigga         1"],"text/html":["\n","  <div id=\"df-c4203c13-e222-41c0-852d-0cdea26c5d17\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>oh_label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Ain't good head pussy curl yah toes up&amp;😂&amp;😩</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>bona fide quick check . instance;</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>claims is. That's logical explanation.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>RODRICK BAD THING LIKE HE'S DICK HE'S ENJOYABL...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Pretty sure got ya bitch nudes phone nigga</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-c4203c13-e222-41c0-852d-0cdea26c5d17')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-c4203c13-e222-41c0-852d-0cdea26c5d17 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-c4203c13-e222-41c0-852d-0cdea26c5d17');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":14}],"source":["df['Text'] = df['Text'].apply(nfx.remove_stopwords)\n","df.head()"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1686926819865,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"91opN0nPnuQ9","outputId":"8a5f0621-0676-4628-a902-af5b4a96f673"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    Text  oh_label\n","15362  ` wasted bit sexuality, read diatribe thing AB...         1\n","15363  Erik, crying loud. legally sex children, under...         1\n","15364  BOOBS, BOOBS, BOOBS, BOOBS, BOOBS, BOOBS, BOOB...         1\n","15365                         ```Nazi filth`` impolite `         1\n","15366  Prior Quickpolls, perma-blocked now. Guess I'l...         1"],"text/html":["\n","  <div id=\"df-9bee3d19-ab08-47db-9f06-9436cc9a0ad0\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>oh_label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>15362</th>\n","      <td>` wasted bit sexuality, read diatribe thing AB...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>15363</th>\n","      <td>Erik, crying loud. legally sex children, under...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>15364</th>\n","      <td>BOOBS, BOOBS, BOOBS, BOOBS, BOOBS, BOOBS, BOOB...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>15365</th>\n","      <td>```Nazi filth`` impolite `</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>15366</th>\n","      <td>Prior Quickpolls, perma-blocked now. Guess I'l...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9bee3d19-ab08-47db-9f06-9436cc9a0ad0')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9bee3d19-ab08-47db-9f06-9436cc9a0ad0 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9bee3d19-ab08-47db-9f06-9436cc9a0ad0');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":18}],"source":["df1 = df[df['oh_label'] == 1]\n","df1.head()"]},{"cell_type":"code","source":[],"metadata":{"id":"MJBQ222Ode2w"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GqUqV4bFoBtf"},"source":["## Train, Test set 나누기"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":8,"status":"ok","timestamp":1688160941296,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"KILHGANjoBPA","outputId":"ef69c7f5-b3d1-4489-a7b5-c5e9d06abcbf"},"outputs":[{"output_type":"stream","name":"stdout","text":["Training set size: 58863\n","Validation set size: 12613\n","Test set size: 12614\n"]}],"source":["from sklearn.model_selection import train_test_split\n","\n","df_train, df_temp = train_test_split(df, test_size=0.3, random_state=42)\n","df_val, df_test = train_test_split(df_temp, test_size=0.5, random_state=42)\n","\n","df_train = df_train.reset_index(drop=True)\n","df_val = df_val.reset_index(drop=True)\n","df_test = df_test.reset_index(drop=True)\n","\n","print(f\"Training set size: {len(df_train)}\")\n","print(f\"Validation set size: {len(df_val)}\")\n","print(f\"Test set size: {len(df_test)}\")\n","\n"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"executionInfo":{"elapsed":386,"status":"ok","timestamp":1688160944488,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"i2JjRNN0ocy3","outputId":"ba6351ff-17bd-4763-9bc4-2cf31986df38"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    Text  oh_label\n","58858                        Monte... fuckin knows point         1\n","58859             Rapesfuges refuse register going ISIS.         1\n","58860  Niggas depressed lil app😂 y’all screaming “fuc...         1\n","58861  white trash allowed stage time? college suppos...         1\n","58862  going stand actual person bullying. 5 language...         1"],"text/html":["\n","  <div id=\"df-e1ff6d90-8ce8-487d-bd30-e3b6991def79\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Text</th>\n","      <th>oh_label</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>58858</th>\n","      <td>Monte... fuckin knows point</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>58859</th>\n","      <td>Rapesfuges refuse register going ISIS.</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>58860</th>\n","      <td>Niggas depressed lil app😂 y’all screaming “fuc...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>58861</th>\n","      <td>white trash allowed stage time? college suppos...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>58862</th>\n","      <td>going stand actual person bullying. 5 language...</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-e1ff6d90-8ce8-487d-bd30-e3b6991def79')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-e1ff6d90-8ce8-487d-bd30-e3b6991def79 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-e1ff6d90-8ce8-487d-bd30-e3b6991def79');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":16}],"source":["df_train.tail()"]},{"cell_type":"markdown","metadata":{"id":"BQkoEWNCP3s-"},"source":["## 로베르타 인풋 만들기\n"]},{"cell_type":"code","source":["from transformers import DebertaForSequenceClassification, DebertaTokenizer\n","\n","MODEL_PATH = '/content/drive/My Drive/bert/deberta_ver1_base_new'\n","MODEL_TYPE = 'microsoft/deberta-base'\n","\n","model = DebertaForSequenceClassification.from_pretrained(MODEL_PATH) # XLM-RoBERTa 모델 로드\n","tokenizer = DebertaTokenizer.from_pretrained(MODEL_TYPE) #\n","\n","\n"],"metadata":{"id":"-XgVx2tbds1A","executionInfo":{"status":"ok","timestamp":1688160963788,"user_tz":-120,"elapsed":16259,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"colab":{"base_uri":"https://localhost:8080/","height":145,"referenced_widgets":["2f078cec635c4a768a321c9bd596b3c9","f1627a27dece43ff85139ab7c93f474b","3787cda643a840b982e7c6fd6f3b76e8","22c2f0630b5d4b789300442799224975","6916efad1b724c2a8968bca5e39177ca","8405d7b28de7411e9ed4f8dd2ef6c7a0","933fdc2a9cdf4e2b8f18cfe4987d0fe8","b5bdb56a67334187aad57eba49653ffd","a7fa207346fd46cea130ca18e07177db","9e099c3707844f649d4e97988b10b0e1","d962465d8d2c46b3a9a4b07ae21616cd","8b75e7db4b854fd381407f198dd8fc0e","e2c441997ede4fe094dd0715609690ff","fcae748fe7e449cc9123e3fae143fc44","661420708f6c4784a2f87a56bb569408","a897ce8ad5694aeeb8d023c019061ff5","cb1f124f3614435583fdb4105737cf17","a724c58338f54bc293cfaef370bad4af","4b607dd484df4f8c915d5ea25818f960","51a5425df71a4fe1a763a0bd49ceb45d","0d0e9bb42e3646ee9a79d0496332ca0e","85c4717ec6c944f1bdb2b6101f0e45aa","468a1a3ed8c24e4e910cc4b260f314e2","2d3c73d120654b79aa03aded8feb14c9","8ca044d946c247059128e97fde6565e3","faf4b2c727db49b3bb208789156b27b3","d44ee2fb307f49fb8c5a302dbe6fe78d","fdbc430db40146fa86648587058db5c5","98d161c0440a4daa97dfc60e28e4bac6","642e5299244e4bcbbb694f707d1f1bae","55b29c7c43cd4d13b8f974873497d72c","bf39366b9d064136b00a1b34f9128e99","944070bb40b74428b934150996078d4b","177496e460ad41ada4ff06a16b29bb56","a8d41bc484c44e7f9f7902f645283257","f0aae3cd56e5408188f70fd99041b3f9","a832cf813bf247a09b0980d1e53ca35e","1504a77417624ef18612545e482b39de","8bbca837567a4462b8068af55b4ebd3f","4ed617bfdc0240ce90aa54a504f988bc","208718980da74c90914c86108e968e28","14b1314682104c0db1bf02258953a8c3","5a49bc8488fa491a933c70be2474e93a","ec71a6d6eb574248b990abaefd3b1340"]},"outputId":"3069388e-2b3a-4fd4-b57f-28af5b16fa0b"},"execution_count":17,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/vocab.json:   0%|          | 0.00/899k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2f078cec635c4a768a321c9bd596b3c9"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)olve/main/merges.txt:   0%|          | 0.00/456k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8b75e7db4b854fd381407f198dd8fc0e"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)okenizer_config.json:   0%|          | 0.00/52.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"468a1a3ed8c24e4e910cc4b260f314e2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading (…)lve/main/config.json:   0%|          | 0.00/474 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"177496e460ad41ada4ff06a16b29bb56"}},"metadata":{}}]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":7,"status":"ok","timestamp":1688160963788,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"gir8arEjt3K7","outputId":"b9911400-bd5b-43a2-ac1f-27787410f74f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["50265"]},"metadata":{},"execution_count":18}],"source":["# vocab크기 확인\n","tokenizer.vocab_size"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":6,"status":"ok","timestamp":1688160963788,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"Uycf7U7gt6Xq","outputId":"1446330c-37ef-476e-ddd4-b5a39983081c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["['[PAD]', '[CLS]', '[SEP]', '[UNK]', '!', '\"', '#', '$', '%', '&']"]},"metadata":{},"execution_count":19}],"source":["\n","list(tokenizer.get_vocab())[:10]"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1688160963788,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"xTGYhPwNt71q","outputId":"7bd8844a-f547-4f11-b096-6ce7a7efa4c9"},"outputs":[{"output_type":"stream","name":"stdout","text":["Fri Jun 30 21:36:03 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.85.12    Driver Version: 525.85.12    CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   53C    P8    10W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["!nvidia-smi"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":369,"status":"ok","timestamp":1688160973087,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"5Qing-DUxcKf","outputId":"7df94b42-a5b5-4f7a-f292-68a5b8f0ed61"},"outputs":[{"output_type":"stream","name":"stdout","text":["cuda:0\n"]}],"source":["# device 설정\n","device= torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\n","\n","print(device)"]},{"cell_type":"code","execution_count":22,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2,"status":"ok","timestamp":1688160974352,"user":{"displayName":"Mini Som","userId":"12478799869498271302"},"user_tz":-120},"id":"dqj3HWr-pOxU","outputId":"e28c0570-6fb4-43d6-9677-da206067234b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["2"]},"metadata":{},"execution_count":22}],"source":["L_RATE = 1e-5\n","MAX_LEN = 256\n","\n","BATCH_SIZE = 32 # batch size가 클수록 global minimum에 도달하는 속도가 증가합니다. (GPU 메모리에 따라 변경해 주세요, 너무 크면 OOM 문제가 발생합니다.)\n","NUM_CORES = os.cpu_count() # Dataloader에 사용됩니다.\n","\n","NUM_CORES"]},{"cell_type":"code","source":["####### 인풋 선언 #####\n","# test 예측에 사용\n","class TestDataset(Dataset):\n","\n","    def __init__(self, df_test):\n","        self.df = df_test\n","\n","    def __getitem__(self, index):\n","\n","        sentence1 = self.df.loc[index, 'Text']\n","\n","        encoded_dict = tokenizer.encode_plus(\n","                    sentence1,\n","                    add_special_tokens = True,\n","                    max_length = MAX_LEN,\n","                    pad_to_max_length = True,\n","                    return_attention_mask = True,\n","                    truncation=True,\n","                    return_tensors = 'pt',\n","               )\n","\n","        padded_token_list = encoded_dict['input_ids'][0]\n","        att_mask = encoded_dict['attention_mask'][0]\n","        # input_ids, attention_mask를 하나의 인풋으로 묶음\n","        sample = (padded_token_list, att_mask)\n","\n","        return sample\n","\n","\n","    def __len__(self):\n","        return len(self.df)\n"],"metadata":{"id":"60sDVW6ThoVr","executionInfo":{"status":"ok","timestamp":1688160981418,"user_tz":-120,"elapsed":505,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":23,"outputs":[]},{"cell_type":"code","source":["# Use the configuration to initialize the model\n","model = DebertaForSequenceClassification.from_pretrained(\n","    '/content/drive/My Drive/bert/deberta_ver1_base_new',  # 학습된 모델의 경로를 지정해야 합니다.\n",")\n","model.to(device)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"JzMp9IQVhrqL","executionInfo":{"status":"ok","timestamp":1688160997980,"user_tz":-120,"elapsed":13767,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"bdcc8b86-55b0-4bd0-b657-1410bc056062"},"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DebertaForSequenceClassification(\n","  (deberta): DebertaModel(\n","    (embeddings): DebertaEmbeddings(\n","      (word_embeddings): Embedding(50265, 768, padding_idx=0)\n","      (LayerNorm): DebertaLayerNorm()\n","      (dropout): StableDropout()\n","    )\n","    (encoder): DebertaEncoder(\n","      (layer): ModuleList(\n","        (0-11): 12 x DebertaLayer(\n","          (attention): DebertaAttention(\n","            (self): DisentangledSelfAttention(\n","              (in_proj): Linear(in_features=768, out_features=2304, bias=False)\n","              (pos_dropout): StableDropout()\n","              (pos_proj): Linear(in_features=768, out_features=768, bias=False)\n","              (pos_q_proj): Linear(in_features=768, out_features=768, bias=True)\n","              (dropout): StableDropout()\n","            )\n","            (output): DebertaSelfOutput(\n","              (dense): Linear(in_features=768, out_features=768, bias=True)\n","              (LayerNorm): DebertaLayerNorm()\n","              (dropout): StableDropout()\n","            )\n","          )\n","          (intermediate): DebertaIntermediate(\n","            (dense): Linear(in_features=768, out_features=3072, bias=True)\n","            (intermediate_act_fn): GELUActivation()\n","          )\n","          (output): DebertaOutput(\n","            (dense): Linear(in_features=3072, out_features=768, bias=True)\n","            (LayerNorm): DebertaLayerNorm()\n","            (dropout): StableDropout()\n","          )\n","        )\n","      )\n","      (rel_embeddings): Embedding(1024, 768)\n","    )\n","  )\n","  (pooler): ContextPooler(\n","    (dense): Linear(in_features=768, out_features=768, bias=True)\n","    (dropout): StableDropout()\n","  )\n","  (classifier): Linear(in_features=768, out_features=2, bias=True)\n","  (dropout): StableDropout()\n",")"]},"metadata":{},"execution_count":24}]},{"cell_type":"code","source":["# Test Dataset and DataLoader\n","test_dataset = TestDataset(df_test)\n","test_dataloader = DataLoader(\n","    test_dataset,\n","    batch_size=BATCH_SIZE,\n","    num_workers=NUM_CORES\n",")\n"],"metadata":{"id":"yZwDYQlAhujG","executionInfo":{"status":"ok","timestamp":1688160997980,"user_tz":-120,"elapsed":2,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["# Evaluation\n","model.eval()\n","\n","predictions = []\n","\n","for batch in test_dataloader:\n","    b_input_ids = batch[0].to(device)\n","    b_input_mask = batch[1].to(device)\n","\n","    with torch.no_grad():\n","        outputs = model(b_input_ids,\n","                        token_type_ids=None,\n","                        attention_mask=b_input_mask)\n","\n","    logits = outputs[0]\n","    logits = logits.detach().cpu().numpy()\n","    predictions.append(logits)"],"metadata":{"id":"adrwHB4BhyfK","executionInfo":{"status":"ok","timestamp":1688161240403,"user_tz":-120,"elapsed":242424,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["\n","from sklearn.metrics import classification_report, confusion_matrix, f1_score\n","import seaborn as sns\n","import matplotlib.pyplot as plt\n","import numpy as np\n","\n","# Flatten the predictions and true values\n","flat_predictions = [item for sublist in predictions for item in sublist]\n","flat_predictions = np.argmax(flat_predictions, axis=1).flatten()\n","\n","# Get the true labels (replace this with your own method if necessary)\n","flat_true_labels = df_test['oh_label'].tolist()  # this assumes that df_test['oh_label'] contains the true labels\n","\n","# Calculate the F1 score\n","f1 = f1_score(flat_true_labels, flat_predictions, average='weighted')\n","print(f'F1 Score: {f1}')\n","\n","# Create a confusion matrix\n","cm = confusion_matrix(flat_true_labels, flat_predictions)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":366},"id":"d01AIKWqmyHo","executionInfo":{"status":"error","timestamp":1688161650187,"user_tz":-120,"elapsed":416,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"23eacbb5-6c9d-4ed6-cab1-4ee19f845a5e"},"execution_count":30,"outputs":[{"output_type":"error","ename":"TypeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-30-da34c0c7d108>\u001b[0m in \u001b[0;36m<cell line: 7>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;31m# Flatten the predictions and true values\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mflat_predictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mitem\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0msublist\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpredictions\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mitem\u001b[0m \u001b[0;32min\u001b[0m \u001b[0msublist\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mflat_predictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mflat_predictions\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflatten\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m<ipython-input-30-da34c0c7d108>\u001b[0m in \u001b[0;36m<listcomp>\u001b[0;34m(.0)\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;31m# Flatten the predictions and true values\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mflat_predictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m[\u001b[0m\u001b[0mitem\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0msublist\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mpredictions\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mitem\u001b[0m \u001b[0;32min\u001b[0m \u001b[0msublist\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0mflat_predictions\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mflat_predictions\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mflatten\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mTypeError\u001b[0m: 'numpy.int64' object is not iterable"]}]},{"cell_type":"code","source":["from sklearn.metrics import classification_report\n","# TestDataset을 df_test로 초기화\n","test_data = TestDataset(df_test)\n","\n","# DataLoader를 다시 초기화\n","test_dataloader = DataLoader(test_data, batch_size=BATCH_SIZE, shuffle=False, num_workers=NUM_CORES)\n","\n","model.eval() #모델 평가모드로 전환 (추가함)\n","\n","predictions = [] # 예측 결과를 저장할 리스트 초기화\n","\n","# 테스트 시작 (XML-RoBERTa)\n","for j, batch in enumerate(test_dataloader):\n","    inference_status = 'Batch ' + str(j+1) + ' of ' + str(len(test_dataloader))\n","    print(inference_status, end='\\r')\n","\n","    b_input_ids = batch[0].to(device)\n","    b_input_mask = batch[1].to(device)\n","    with torch.no_grad():  # 기울기 계산 비활성화\n","        outputs = model(b_input_ids, attention_mask=b_input_mask)\n","\n","    logits = outputs[0]\n","    preds = torch.argmax(logits, dim=1)\n","    predictions.extend(preds.cpu().numpy()) # 예측 결과를 predictions에 추가\n","\n","# y_true: 실제 레이블\n","y_true = df_test['oh_label']\n","\n","# classification_report 출력\n","report = classification_report(y_true, predictions, digits=3)\n","print(report)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"MNiNbFd8nb-C","executionInfo":{"status":"ok","timestamp":1688161480328,"user_tz":-120,"elapsed":239946,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"635d46b8-c81d-41f0-eb3e-c680960cc947"},"execution_count":27,"outputs":[{"output_type":"stream","name":"stdout","text":["              precision    recall  f1-score   support\n","\n","           0      0.809     0.333     0.471      6276\n","           1      0.583     0.922     0.714      6338\n","\n","    accuracy                          0.629     12614\n","   macro avg      0.696     0.627     0.593     12614\n","weighted avg      0.695     0.629     0.593     12614\n","\n"]}]},{"cell_type":"markdown","metadata":{"id":"ggeRRqq_b2c_"},"source":[]},{"cell_type":"code","source":["from sklearn.metrics import confusion_matrix\n","import seaborn as sns\n","\n","# Confusion Matrix\n","cm = confusion_matrix(y_true, predictions)\n","\n","plt.figure(figsize=(10, 7))\n","sns.heatmap(cm, annot=True, fmt=\".0f\", linewidths=.5, square=True, cmap='Reds')\n","plt.ylabel('Actual label')\n","plt.xlabel('Predicted label')\n","plt.title('DeBERTa Confusion Matrix')\n","plt.show()\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":241},"id":"fphEOqjM5Cvk","executionInfo":{"status":"error","timestamp":1688161577783,"user_tz":-120,"elapsed":500,"user":{"displayName":"Mini Som","userId":"12478799869498271302"}},"outputId":"5828024f-a326-4bc5-f3b9-2b37ad0451d8"},"execution_count":29,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-29-c5d4d7016fff>\u001b[0m in \u001b[0;36m<cell line: 7>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0mcm\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mconfusion_matrix\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0my_true\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mpredictions\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      6\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 7\u001b[0;31m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfigure\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfigsize\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m10\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m7\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      8\u001b[0m \u001b[0msns\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mheatmap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcm\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mannot\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfmt\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m\".0f\"\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlinewidths\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;36m.5\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0msquare\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mcmap\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'Reds'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0mplt\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mylabel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'Actual label'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'plt' is not defined"]}]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1ht6SCNMuSPt-vJDw3ajKrgQf2gRGDU4-","timestamp":1688160760340},{"file_id":"1cPy0qh3q2HaArKSs2V7t-R5wtsVmkxrW","timestamp":1686942522526},{"file_id":"1tG2QRQUvwfRCLGAneuCpJuQh6eEMylif","timestamp":1686927572047},{"file_id":"1dzwRrLNSUvmSU7lkLpM4h_oXVbA8xR2f","timestamp":1686924928629},{"file_id":"1BPqxKs0BJA4AYYcQAd0d0cnkWCiQds9S","timestamp":1686604161141},{"file_id":"1KOMyn_U6f_Fjcpfla1BzPs7l8D6ntg6m","timestamp":1686338987380},{"file_id":"1cAgf4VB6I7quphc68jLcqHP_Qfqn84xy","timestamp":1685879136115},{"file_id":"1UuBjy2xsMtEsHC0IObOyISzdqqONZVup","timestamp":1685832364841},{"file_id":"1ahuzEwCqRZ6lcWM-ZiZv_qhxTd91f62k","timestamp":1685644361248},{"file_id":"15HNkg5YHgLOcheac2e3RH0I45OVgR5KB","timestamp":1685638403770},{"file_id":"1GKJdeU9NuF_3iBE2JFg_XqGyDY0X0vd9","timestamp":1685481553382},{"file_id":"1rNYhiOdc0q2seie8rl5CaoRVB_MKSZ9d","timestamp":1685455913355},{"file_id":"16P6tHxXRjitcznlMFOfv1Jn7bys7mEYi","timestamp":1685118567083},{"file_id":"1NKZddixL2pqCUo4n4z5N7aJ2hQvrPHLy","timestamp":1685050787971}],"gpuType":"T4"},"kernelspec":{"display_name":"Python 3","name":"python3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"2f078cec635c4a768a321c9bd596b3c9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_f1627a27dece43ff85139ab7c93f474b","IPY_MODEL_3787cda643a840b982e7c6fd6f3b76e8","IPY_MODEL_22c2f0630b5d4b789300442799224975"],"layout":"IPY_MODEL_6916efad1b724c2a8968bca5e39177ca"}},"f1627a27dece43ff85139ab7c93f474b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8405d7b28de7411e9ed4f8dd2ef6c7a0","placeholder":"​","style":"IPY_MODEL_933fdc2a9cdf4e2b8f18cfe4987d0fe8","value":"Downloading (…)olve/main/vocab.json: 100%"}},"3787cda643a840b982e7c6fd6f3b76e8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b5bdb56a67334187aad57eba49653ffd","max":898825,"min":0,"orientation":"horizontal","style":"IPY_MODEL_a7fa207346fd46cea130ca18e07177db","value":898825}},"22c2f0630b5d4b789300442799224975":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_9e099c3707844f649d4e97988b10b0e1","placeholder":"​","style":"IPY_MODEL_d962465d8d2c46b3a9a4b07ae21616cd","value":" 899k/899k [00:00&lt;00:00, 1.08MB/s]"}},"6916efad1b724c2a8968bca5e39177ca":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8405d7b28de7411e9ed4f8dd2ef6c7a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"933fdc2a9cdf4e2b8f18cfe4987d0fe8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b5bdb56a67334187aad57eba49653ffd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a7fa207346fd46cea130ca18e07177db":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"9e099c3707844f649d4e97988b10b0e1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"d962465d8d2c46b3a9a4b07ae21616cd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8b75e7db4b854fd381407f198dd8fc0e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_e2c441997ede4fe094dd0715609690ff","IPY_MODEL_fcae748fe7e449cc9123e3fae143fc44","IPY_MODEL_661420708f6c4784a2f87a56bb569408"],"layout":"IPY_MODEL_a897ce8ad5694aeeb8d023c019061ff5"}},"e2c441997ede4fe094dd0715609690ff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_cb1f124f3614435583fdb4105737cf17","placeholder":"​","style":"IPY_MODEL_a724c58338f54bc293cfaef370bad4af","value":"Downloading (…)olve/main/merges.txt: 100%"}},"fcae748fe7e449cc9123e3fae143fc44":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_4b607dd484df4f8c915d5ea25818f960","max":456318,"min":0,"orientation":"horizontal","style":"IPY_MODEL_51a5425df71a4fe1a763a0bd49ceb45d","value":456318}},"661420708f6c4784a2f87a56bb569408":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0d0e9bb42e3646ee9a79d0496332ca0e","placeholder":"​","style":"IPY_MODEL_85c4717ec6c944f1bdb2b6101f0e45aa","value":" 456k/456k [00:00&lt;00:00, 718kB/s]"}},"a897ce8ad5694aeeb8d023c019061ff5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cb1f124f3614435583fdb4105737cf17":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a724c58338f54bc293cfaef370bad4af":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"4b607dd484df4f8c915d5ea25818f960":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"51a5425df71a4fe1a763a0bd49ceb45d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"0d0e9bb42e3646ee9a79d0496332ca0e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"85c4717ec6c944f1bdb2b6101f0e45aa":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"468a1a3ed8c24e4e910cc4b260f314e2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_2d3c73d120654b79aa03aded8feb14c9","IPY_MODEL_8ca044d946c247059128e97fde6565e3","IPY_MODEL_faf4b2c727db49b3bb208789156b27b3"],"layout":"IPY_MODEL_d44ee2fb307f49fb8c5a302dbe6fe78d"}},"2d3c73d120654b79aa03aded8feb14c9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_fdbc430db40146fa86648587058db5c5","placeholder":"​","style":"IPY_MODEL_98d161c0440a4daa97dfc60e28e4bac6","value":"Downloading (…)okenizer_config.json: 100%"}},"8ca044d946c247059128e97fde6565e3":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_642e5299244e4bcbbb694f707d1f1bae","max":52,"min":0,"orientation":"horizontal","style":"IPY_MODEL_55b29c7c43cd4d13b8f974873497d72c","value":52}},"faf4b2c727db49b3bb208789156b27b3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_bf39366b9d064136b00a1b34f9128e99","placeholder":"​","style":"IPY_MODEL_944070bb40b74428b934150996078d4b","value":" 52.0/52.0 [00:00&lt;00:00, 3.99kB/s]"}},"d44ee2fb307f49fb8c5a302dbe6fe78d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fdbc430db40146fa86648587058db5c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"98d161c0440a4daa97dfc60e28e4bac6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"642e5299244e4bcbbb694f707d1f1bae":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"55b29c7c43cd4d13b8f974873497d72c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"bf39366b9d064136b00a1b34f9128e99":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"944070bb40b74428b934150996078d4b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"177496e460ad41ada4ff06a16b29bb56":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a8d41bc484c44e7f9f7902f645283257","IPY_MODEL_f0aae3cd56e5408188f70fd99041b3f9","IPY_MODEL_a832cf813bf247a09b0980d1e53ca35e"],"layout":"IPY_MODEL_1504a77417624ef18612545e482b39de"}},"a8d41bc484c44e7f9f7902f645283257":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8bbca837567a4462b8068af55b4ebd3f","placeholder":"​","style":"IPY_MODEL_4ed617bfdc0240ce90aa54a504f988bc","value":"Downloading (…)lve/main/config.json: 100%"}},"f0aae3cd56e5408188f70fd99041b3f9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_208718980da74c90914c86108e968e28","max":474,"min":0,"orientation":"horizontal","style":"IPY_MODEL_14b1314682104c0db1bf02258953a8c3","value":474}},"a832cf813bf247a09b0980d1e53ca35e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_5a49bc8488fa491a933c70be2474e93a","placeholder":"​","style":"IPY_MODEL_ec71a6d6eb574248b990abaefd3b1340","value":" 474/474 [00:00&lt;00:00, 39.1kB/s]"}},"1504a77417624ef18612545e482b39de":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8bbca837567a4462b8068af55b4ebd3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ed617bfdc0240ce90aa54a504f988bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"208718980da74c90914c86108e968e28":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14b1314682104c0db1bf02258953a8c3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"5a49bc8488fa491a933c70be2474e93a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec71a6d6eb574248b990abaefd3b1340":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}